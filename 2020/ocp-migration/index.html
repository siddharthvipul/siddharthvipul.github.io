<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="SiddharthVipul">
  
  
  
  <link rel="prev" href="https://vipul.dev/2019/flock_to_fedora_2019/" />
  <link rel="next" href="https://vipul.dev/2020/my_wfh_setup/" />
  <link rel="canonical" href="https://vipul.dev/2020/ocp-migration/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           Migrating jobs to new OCP4 cluster | SiddharthVipul
       
  </title>
  <meta name="title" content="Migrating jobs to new OCP4 cluster | SiddharthVipul">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/vipul.dev"
    },
    "articleSection" : "posts",
    "name" : "Migrating jobs to new OCP4 cluster",
    "headline" : "Migrating jobs to new OCP4 cluster",
    "description" : "Action If you are currently using apps.ci.centos.org (OCP 3.6) or have a job running in ci.centos.org, please contact us so that we can create a namespace for you in the new OCP 4.4 cluster for you to start migrating your jobs.\nIf your own a namespace on apps.ci.centos.org There shouldn\u0026rsquo;t be a lot of changes for you as you already have a workflow known to openshift and you have configured your jobs once.",
    "inLanguage" : "en-us",
    "author" : "SiddharthVipul",
    "creator" : "SiddharthVipul",
    "publisher": "SiddharthVipul",
    "accountablePerson" : "SiddharthVipul",
    "copyrightHolder" : "SiddharthVipul",
    "copyrightYear" : "2020",
    "datePublished": "2020-07-08 00:00:00 \u002b0000 UTC",
    "dateModified" : "2020-07-08 00:00:00 \u002b0000 UTC",
    "url" : "https:\/\/vipul.dev\/2020\/ocp-migration\/",
    "wordCount" : "558",
    "keywords" : [  "SiddharthVipul"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://vipul.dev">SiddharthVipul</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/gpg.txt" title="">gpg.pub</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://vipul.dev">SiddharthVipul</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>

          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/gpg.txt" title="">gpg.pub</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>

    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Migrating jobs to new OCP4 cluster</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://vipul.dev" rel="author">SiddharthVipul</a> with ♥ 
                <span class="post-time">
                on <time datetime=2020-07-08 itemprop="datePublished">July 8, 2020</time>
                </span>
                in
                
        </div>
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <h1 id="action">Action</h1>
<p>If you are currently using apps.ci.centos.org (OCP 3.6) or have a job running in ci.centos.org, please contact us so that we can create a namespace for you in the new OCP 4.4 cluster for you to start migrating your jobs.</p>
<h2 id="if-your-own-a-namespace-on-appscicentosorg">If your own a namespace on apps.ci.centos.org</h2>
<p>There shouldn&rsquo;t be a lot of changes for you as you already have a workflow known to openshift and you have configured your jobs once. While opening a ticket, or reaching out to us please do mention if you need ability to checkout duffy nodes (if yes, do you already have a duffy API key?).</p>
<p>here is how to open a ticket (link to open a migration ticket)</p>
<h2 id="if-your-project-is-on-cicentosorg">If your project is on ci.centos.org</h2>
<p>As you are using central jenkins deployment that&rsquo;s not private to you, your project might see some changes. You will have your own jenkins deployment to run all your jobs instead of having a shared jenkins instance where you don&rsquo;t have admin access. With the extra privilage in jenkins, you can add plugins, credentials as you need and a bunch of other abilities.
This also means there is no direct maintenance required from CentOS CI Infra admins as openshift takes care of things dying or crashing and anything in the jobs config, you can take care of them yourself (We will help you get started and are always in reach if you notice any hiccups that is not auto healed). You can have the same workflow or use this opportunity to change your freestyle jobs to pipelines but that&rsquo;s totally on you.
here is how to open a ticket (link to open a migration ticket)</p>
<h3 id="open-a-project-ticket">open a project ticket</h3>
<ul>
<li>login to bugs.centos.org</li>
<li>Select CentOS CI project</li>
<li>Create an issue with following info (You can also comment in a different field if you prefer your email addresses to be private)</li>
</ul>
<pre><code>namespace name:
namespace admins
 - user1@email.com // email address used in accounts.centos.org
 - user2@email.com // email address used in accounts.centos.org

Do you use baremetal nodes for your jobs?: Yes/No
</code></pre><ul>
<li>Assign it to <code>siddharthvipul1</code> or <code>dkirwan</code></li>
</ul>
<p>We will have your accounts created in 48 hours (if no doubts/followup needed).
Note: This is only applicable for already existing projects in other places. New projects will have to go through a different process/evaluation and we may need more time.</p>
<h2 id="setting-up-your-jobs-in-cico-workspace-jenkins">Setting up your jobs in cico-workspace jenkins</h2>
<p>Configuring your jobs should be similar to your older configuration. You can either have your jobs written in jenkinsfile dialogue box, or source it from your repo (we recommend the later for easy management of jenkinsfile). One thing to point, in groovy, the node parameter type defines where the target job should be executed, the value must match either a label or a node name - otherwise the job will just stay in the queue.
We have a custom label called <code>cico-workspace</code> that has python-cicoclient installed in it so that you can request duffy nodes. This workspace will also have your duffy-api-key exported so that you can directly request nodes from duffy. Here is an example of jenkins file</p>
<pre><code>node('cico-workspace') {
    stage('get cico node') {
		node = sh(script: &quot;cico node get --release=8&quot;, returnStdout: true).trim().tokenize(' ')
		env.node_hostname = &quot;${node[0]}.ci.centos.org&quot;
		env.node_ssid = &quot;${node[1]}&quot;
	}

    stage('tests-example') {
        pass
    }

    stage('builds-example') {
        pass
    }

    finally {
        stage('return bare-metal machine') {
			sh 'cico node done ${CICO_SSID}'
        }
    }
}
</code></pre>
    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>SiddharthVipul </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://vipul.dev/2020/ocp-migration/>https://vipul.dev/2020/ocp-migration/</span>
            </p>
            
            
    </div>

  
    <div class="post-tags">
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://vipul.dev">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://vipul.dev/2019/flock_to_fedora_2019/" class="prev" rel="prev" title="Flock to Fedora 2019"><i class="iconfont icon-left"></i>&nbsp;Flock to Fedora 2019</a>
         
        
        <a href="https://vipul.dev/2020/my_wfh_setup/" class="next" rel="next" title="My work-from-home setup">My work-from-home setup&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2018 - 2022</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://vipul.dev">SiddharthVipul</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
